<html lang='en' dir='ltr'>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <meta name='color-scheme' content='light' />
    <meta name='supported-color-schemes' content='light' />
    <title>{{companyName}} - Card Expiry Alert</title>
    <style>
      body { margin: 0; padding: 0; width: 100%; font-family: 'Segoe UI', Tahoma, Geneva, Verdana,
      sans-serif; font-size: 15px; line-height: 1.6; color: #2d3748; background-color: #f7fafc; }
      .email-wrapper { padding: 40px 20px; background-color: #f7fafc; } .email-container {
      max-width: 700px; margin: 0 auto; background-color: #ffffff; border-radius: 8px; box-shadow: 0
      4px 6px rgba(0, 0, 0, 0.07); overflow: hidden; } .header { background: linear-gradient(135deg,
      #1a365d 0%, #2c5282 100%); padding: 32px 40px; text-align: center; } .logo { max-width: 120px;
      height: auto; display: block; margin: 0 auto 16px; border-radius: 8px; } .company-name {
      color: #ffffff; font-size: 22px; font-weight: 600; margin: 0; letter-spacing: 0.5px; }
      .content { padding: 40px; } .greeting { font-size: 16px; color: #1a365d; margin-bottom: 20px;
      } .message-text { color: #4a5568; margin-bottom: 24px; line-height: 1.7; } /* Section Headers
      */ .section-header { display: flex; align-items: center; gap: 12px; margin: 32px 0 16px 0; }
      .section-header.expired { color: #c53030; } .section-header.expiring { color: #92400e; }
      .section-icon { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items:
      center; justify-content: center; font-size: 14px; font-weight: bold; } .section-header.expired
      .section-icon { background-color: #fed7d7; color: #c53030; } .section-header.expiring
      .section-icon { background-color: #fef3c7; color: #92400e; } .section-title { font-size: 16px;
      font-weight: 600; margin: 0; } /* Card Item */ .card-item { background-color: #f7fafc; border:
      1px solid #e2e8f0; border-radius: 8px; margin-bottom: 16px; overflow: hidden; }
      .card-item.expired { border-left: 4px solid #c53030; } .card-item.expiring { border-left: 4px
      solid #f59e0b; } .card-header { padding: 16px 20px; background-color: #edf2f7; border-bottom:
      1px solid #e2e8f0; display: flex; align-items: center; justify-content: space-between; }
      .card-number { font-size: 18px; font-weight: 700; color: #1a365d; margin: 0; font-family:
      'Consolas', 'Monaco', monospace; letter-spacing: 2px; } .card-type-badge { padding: 4px 12px;
      border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase;
      letter-spacing: 0.5px; background-color: #e2e8f0; color: #4a5568; } .card-body { padding: 16px
      20px; } /* Info Grid */ .info-grid { display: grid; grid-template-columns: repeat(3, 1fr);
      gap: 12px; } .info-item { padding: 10px; background-color: #ffffff; border-radius: 6px;
      border: 1px solid #e2e8f0; } .info-label { font-size: 10px; color: #718096; text-transform:
      uppercase; letter-spacing: 0.5px; margin-bottom: 2px; } .info-value { font-size: 13px; color:
      #2d3748; font-weight: 600; } /* Status Badge */ .status-badge { display: inline-block;
      padding: 6px 16px; border-radius: 20px; font-size: 12px; font-weight: 600; text-transform:
      uppercase; letter-spacing: 0.5px; margin-top: 12px; } .status-badge.expired {
      background-color: #fed7d7; color: #c53030; } .status-badge.expiring-soon { background-color:
      #fef3c7; color: #92400e; } /* Legend */ .legend { display: flex; gap: 24px; margin: 24px 0;
      padding: 16px 20px; background-color: #f7fafc; border-radius: 6px; } .legend-item { display:
      flex; align-items: center; gap: 8px; font-size: 12px; color: #4a5568; } .legend-dot { width:
      12px; height: 12px; border-radius: 50%; } .legend-dot.expired { background-color: #c53030; }
      .legend-dot.expiring { background-color: #f59e0b; } /* Button */ .button-container {
      text-align: center; margin: 32px 0; } .button { display: inline-block; padding: 14px 32px;
      background: linear-gradient(135deg, #2c5282 0%, #1a365d 100%); color: #ffffff !important;
      text-decoration: none; border-radius: 6px; font-weight: 600; font-size: 14px; letter-spacing:
      0.5px; } .divider { height: 1px; background-color: #e2e8f0; margin: 28px 0; } .signature {
      margin-top: 28px; color: #4a5568; } .signature-name { color: #1a365d; font-weight: 600; }
      .footer { background-color: #f7fafc; text-align: center; padding: 24px 40px; border-top: 1px
      solid #e2e8f0; } .footer-text { color: #718096; font-size: 12px; margin: 0 0 8px 0; }
      .footer-company { color: #a0aec0; font-size: 11px; margin: 0; } /* Note Box */ .note-box {
      background-color: #dcfce7; border: 1px solid #4ade80; border-left: 4px solid #16a34a; padding:
      16px 20px; border-radius: 0 6px 6px 0; margin: 24px 0; } .note-box p { margin: 0; color:
      #14532d; font-size: 14px; } .note-box strong { color: #166534; } /* Card Visual */
      .card-visual { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); border-radius:
      8px; padding: 16px 20px; color: #ffffff; margin-bottom: 12px; } .card-visual-number {
      font-size: 16px; font-family: 'Consolas', 'Monaco', monospace; letter-spacing: 3px;
      margin-bottom: 12px; } .card-visual-row { display: flex; justify-content: space-between;
      font-size: 11px; text-transform: uppercase; } .card-visual-label { color: #a0c4e8; }
      .card-visual-value { color: #ffffff; font-weight: 600; } @media screen and (max-width: 600px)
      { .content { padding: 28px 24px; } .header { padding: 24px; } .footer { padding: 20px 24px; }
      .card-header { flex-direction: column; align-items: flex-start; gap: 8px; } .info-grid {
      grid-template-columns: 1fr; } .legend { flex-direction: column; gap: 12px; } }
    </style>
  </head>
  <body>
    <div class='email-wrapper'>
      <div class='email-container'>
        <div class='header'>
          <img src='{{companyLogo}}' alt='{{companyName}}' class='logo' />
          <p class='company-name'>{{companyName}}</p>
        </div>

        <div class='content'>
          <p class='greeting'><strong>üí≥ Card Expiry Alert</strong></p>

          <p class='message-text'>
            This is an automated alert regarding cards (Petro, Toll, Fleet) that are expiring or
            have expired. Expired cards may cause payment failures at fuel stations, toll booths,
            and other service points. Please arrange for renewal immediately.
          </p>

          <!-- Summary Cards -->
          <table width='100%' cellpadding='0' cellspacing='0' border='0' style='margin: 24px 0;'>
            {{#if hasExpired}}
              <tr>
                <td style='padding-bottom: 16px;'>
                  <table width='100%' cellpadding='0' cellspacing='0' border='0'>
                    <tr>
                      <td
                        style='background: linear-gradient(135deg, #fed7d7 0%, #feb2b2 100%); border: 1px solid #fc8181; border-radius: 8px; padding: 20px; text-align: center;'
                      >
                        <table width='100%' cellpadding='0' cellspacing='0' border='0'>
                          <tr>
                            <td width='80' style='text-align: center; vertical-align: middle;'>
                              <div
                                style='font-size: 48px; font-weight: 700; line-height: 1; color: #c53030;'
                              >{{totalExpired}}</div>
                            </td>
                            <td
                              style='text-align: left; vertical-align: middle; padding-left: 16px;'
                            >
                              <div style='font-size: 16px; font-weight: 700; color: #c53030;'>Cards
                                Expired</div>
                              <div style='font-size: 12px; color: #9b2c2c; margin-top: 2px;'>Payment
                                failures may occur</div>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            {{/if}}
            {{#if hasExpiringSoon}}
              <tr>
                <td>
                  <table width='100%' cellpadding='0' cellspacing='0' border='0'>
                    <tr>
                      <td
                        style='background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 1px solid #f59e0b; border-radius: 8px; padding: 20px; text-align: center;'
                      >
                        <table width='100%' cellpadding='0' cellspacing='0' border='0'>
                          <tr>
                            <td width='80' style='text-align: center; vertical-align: middle;'>
                              <div
                                style='font-size: 48px; font-weight: 700; line-height: 1; color: #92400e;'
                              >{{totalExpiringSoon}}</div>
                            </td>
                            <td
                              style='text-align: left; vertical-align: middle; padding-left: 16px;'
                            >
                              <div
                                style='font-size: 16px; font-weight: 700; color: #92400e;'
                              >Expiring Soon</div>
                              <div
                                style='font-size: 12px; color: #78350f; margin-top: 2px;'
                              >Initiate renewal process</div>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            {{/if}}
          </table>

          <!-- Legend -->
          <table
            width='100%'
            cellpadding='0'
            cellspacing='0'
            border='0'
            style='background-color: #f7fafc; border-radius: 8px; margin: 24px 0;'
          >
            <tr>
              <td style='padding: 16px 20px;'>
                <table width='100%' cellpadding='0' cellspacing='0' border='0'>
                  <!-- Expired Legend Item -->
                  <tr>
                    <td style='padding-bottom: 12px;'>
                      <table cellpadding='0' cellspacing='0' border='0'>
                        <tr>
                          <td style='width: 20px; vertical-align: middle;'>
                            <div
                              style='width: 12px; height: 12px; min-width: 12px; min-height: 12px; max-width: 12px; max-height: 12px; background-color: #c53030; border-radius: 50%;'
                            ></div>
                          </td>
                          <td
                            style='padding-left: 12px; vertical-align: middle; font-size: 13px; color: #4a5568;'
                          >
                            <strong style='color: #c53030;'>Expired</strong>
                            - Renew immediately
                          </td>
                        </tr>
                      </table>
                    </td>
                  </tr>
                  <!-- Expiring Soon Legend Item -->
                  <tr>
                    <td>
                      <table cellpadding='0' cellspacing='0' border='0'>
                        <tr>
                          <td style='width: 20px; vertical-align: middle;'>
                            <div
                              style='width: 12px; height: 12px; min-width: 12px; min-height: 12px; max-width: 12px; max-height: 12px; background-color: #f59e0b; border-radius: 50%;'
                            ></div>
                          </td>
                          <td
                            style='padding-left: 12px; vertical-align: middle; font-size: 13px; color: #4a5568;'
                          >
                            <strong style='color: #92400e;'>Expiring Soon</strong>
                            - Plan renewal
                          </td>
                        </tr>
                      </table>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>

          {{#if hasExpired}}
            <!-- Expired Cards Section -->
            <table
              width='100%'
              cellpadding='0'
              cellspacing='0'
              border='0'
              style='margin: 32px 0 16px 0;'
            >
              <tr>
                <td width='36' style='vertical-align: middle;'>
                  <div
                    style='width: 28px; height: 28px; background-color: #fed7d7; border-radius: 50%; text-align: center; line-height: 28px;'
                  >
                    <span style='font-size: 16px;'>üö´</span>
                  </div>
                </td>
                <td style='vertical-align: middle; padding-left: 8px;'>
                  <h3 style='font-size: 16px; font-weight: 600; margin: 0; color: #c53030;'>Expired
                    Cards ({{totalExpired}})</h3>
                </td>
              </tr>
            </table>

            {{#each expiredCards}}
              <div class='card-item expired'>
                <div class='card-header'>
                  <p class='card-number'>{{maskedCardNumber}}</p>
                  <span class='card-type-badge'>{{cardTypeLabel}}</span>
                </div>
                <div class='card-body'>
                  <div class='card-visual'>
                    <div class='card-visual-number'>{{maskedCardNumber}}</div>
                    <div class='card-visual-row'>
                      <div>
                        <span class='card-visual-label'>Card Holder</span><br />
                        <span class='card-visual-value'>{{holderName}}</span>
                      </div>
                      <div>
                        <span class='card-visual-label'>Valid Thru</span><br />
                        <span class='card-visual-value'>{{expiryDate}}</span>
                      </div>
                    </div>
                  </div>
                  <div class='info-grid'>
                    <div class='info-item'>
                      <div class='info-label'>Card Type</div>
                      <div class='info-value'>{{cardTypeLabel}}</div>
                    </div>
                    <div class='info-item'>
                      <div class='info-label'>Holder Name</div>
                      <div class='info-value'>{{holderName}}</div>
                    </div>
                    <div class='info-item'>
                      <div class='info-label'>Expiry Date</div>
                      <div class='info-value'>{{expiryDate}}</div>
                    </div>
                  </div>
                  <div style='text-align: center;'>
                    <span class='status-badge {{statusClass}}'>{{daysText}}</span>
                  </div>
                </div>
              </div>
            {{/each}}
          {{/if}}

          {{#if hasExpiringSoon}}
            <!-- Expiring Soon Section -->
            <table
              width='100%'
              cellpadding='0'
              cellspacing='0'
              border='0'
              style='margin: 32px 0 16px 0;'
            >
              <tr>
                <td width='36' style='vertical-align: middle;'>
                  <div
                    style='width: 28px; height: 28px; background-color: #fef3c7; border-radius: 50%; text-align: center; line-height: 28px;'
                  >
                    <span style='font-size: 16px;'>‚ö†Ô∏è</span>
                  </div>
                </td>
                <td style='vertical-align: middle; padding-left: 8px;'>
                  <h3 style='font-size: 16px; font-weight: 600; margin: 0; color: #92400e;'>Expiring
                    Soon ({{totalExpiringSoon}})</h3>
                </td>
              </tr>
            </table>

            {{#each expiringSoonCards}}
              <div class='card-item expiring'>
                <div class='card-header'>
                  <p class='card-number'>{{maskedCardNumber}}</p>
                  <span class='card-type-badge'>{{cardTypeLabel}}</span>
                </div>
                <div class='card-body'>
                  <div class='card-visual'>
                    <div class='card-visual-number'>{{maskedCardNumber}}</div>
                    <div class='card-visual-row'>
                      <div>
                        <span class='card-visual-label'>Card Holder</span><br />
                        <span class='card-visual-value'>{{holderName}}</span>
                      </div>
                      <div>
                        <span class='card-visual-label'>Valid Thru</span><br />
                        <span class='card-visual-value'>{{expiryDate}}</span>
                      </div>
                    </div>
                  </div>
                  <div class='info-grid'>
                    <div class='info-item'>
                      <div class='info-label'>Card Type</div>
                      <div class='info-value'>{{cardTypeLabel}}</div>
                    </div>
                    <div class='info-item'>
                      <div class='info-label'>Holder Name</div>
                      <div class='info-value'>{{holderName}}</div>
                    </div>
                    <div class='info-item'>
                      <div class='info-label'>Expiry Date</div>
                      <div class='info-value'>{{expiryDate}}</div>
                    </div>
                  </div>
                  <div style='text-align: center;'>
                    <span class='status-badge {{statusClass}}'>{{daysText}}</span>
                  </div>
                </div>
              </div>
            {{/each}}
          {{/if}}

          <div class='note-box'>
            <p>
              <strong>üí° Tip:</strong>
              Contact your card issuer well before expiry to ensure uninterrupted service.
              Replacement cards typically take 7-14 business days to arrive.
            </p>
          </div>

          <div class='button-container'>
            <a href='{{adminPortalUrl}}' class='button'>View Card Dashboard</a>
          </div>

          <div class='divider'></div>

          <p class='message-text' style='font-size: 13px;'>
            <strong>Note:</strong>
            Expired cards may result in:
          </p>
          <ul style='color: #4a5568; font-size: 13px; margin: 0 0 20px 0; padding-left: 20px;'>
            <li>Failed fuel purchases at petrol pumps</li>
            <li>Toll payment failures causing delays</li>
            <li>Service disruptions for fleet operations</li>
            <li>Manual reimbursement processing</li>
          </ul>

          <div class='signature'>
            <p>
              Best regards,<br />
              <span class='signature-name'>{{companyName}} HRMS</span>
            </p>
          </div>
        </div>

        <div class='footer'>
          <p class='footer-text'>This is an automated alert. Please do not reply directly to this
            email.</p>
          <p class='footer-company'>&copy;
            {{currentYear}}
            {{companyName}}. All rights reserved.</p>
        </div>
      </div>
    </div>
  </body>
</html>